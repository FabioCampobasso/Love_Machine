<!DOCTYPE html>
<html>
<head>
    <title>Equalizzatore Grafico</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
</head>
<style>

    #equalizzatore {
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 2160px;
        width: 1080px;
        background-image: url('sfondo.png');
        margin-top: 20px;
       
    }

    .tassello {
        height: 80px;
        width: 800px;
        background-color: white;
        margin-top: -4px;
        transition: background-color 0.1s ease;
        border-radius: 50px;
    }

    #equalizzatore .tassello:first-child {
        margin-top: 800px;
    }

    #equalizzatore .tassello:last-child {
        margin-bottom: 800px;
    }

    .input-group {
        text-align: center;
        margin-bottom: 50px;
        margin-top: 95px;
    }

#bottone-calcola {
    height: 450px;
    width: 450px;
    font-size: 40px;
    background-image: url('anim/anim.gif');
    background-color: transparent;
    border: none;
    font-family: 'Roboto', sans-serif;
    font-weight: bold;
    color: #ffffff;
    background-size: cover;
    outline: none;
    border: none;
    z-index: 10px;
}

#testo-bottone {
    opacity: 0; /* Imposta l'opacità iniziale a 0 per renderlo invisibile */
    animation: apparizioneTesto 0s linear 4.5s forwards; /* Animazione per rendere il testo visibile */
}

@keyframes apparizioneTesto {
    to {
        opacity: 1;
    }
}


    iframe {
        scale: 179%;
    }

    #nomeFrase {
        color: #fdecd3;
        font-size: 45px;
        font-weight: bold;
        text-align: center;
        font-family: 'Roboto', sans-serif;
        z-index: 1px;
        justify-content: center;
        left: 50%;
        border: none;
        width: 100%;
        margin-top: 50px;
    }

    #nomeFrase .nomi {
        font-size: 65px;
        color: #fdecd3;
    }

    .container-bottoni {
        text-align: center;
        padding: 20px;
    }

    #bottone1 {
        margin: 80px;
        margin-top: 10px;
        padding: 10px 40px;
        font-size: 45px;
        cursor: pointer;
        border-radius: 50px;
        color: #fdecd3;
        background-color: #f92d83;
        font-weight: bold;
        font-family: 'Roboto Condensed', sans-serif;
        border: none;
    }

    #bottone2 {
        margin: 80px;
        margin-top: 10px;
        padding: 10px 40px;
        font-size: 45px;
        cursor: pointer;
        border-radius: 50px;
        background-color: #fdecd3;
        color: #f92d83;
        font-weight: bold;
        font-family: 'Roboto Condensed', sans-serif;
        text-decoration: none;
        border: none;
    }

    #bottone3 {
        width: 100%;
        height: 150px;
        margin-bottom: -10px;
        border: none;
    }
	
	#container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
z-index: -5px;
}
	.esplosione {
    left: 50%;
    position: absolute;
    opacity: 0;
    transform: scale(0);
    transition: transform 0.5s, opacity 0.5s;
	width: 40px;
	height: 40px;
	z-index: -5px;
}

@keyframes esplosione {
    0% {
        transform: scale(0.5);
        opacity: 1;
    }
    100% {
        transform: scale(1) translate(var(--x), var(--y));
        opacity: 1;
    }
}

@keyframes caduta {
    0% {
        transform: translate(var(--x), var(--y));
    }
    100% {
        transform: translate(var(--x), calc(var(--y) + 4000px)); /* aggiungi qui la distanza di caduta */
       
    }
}

.esploso {
    animation: esplosione 0.5s forwards, caduta 5s 0.5s forwards;
	z-index: -5px;
}
</style>
<body>

   
    <div id="equalizzatore">
	 <div id="container">
        <img src="immagine1.png" class="esplosione" />
        <img src="immagine2.png" class="esplosione" />
        <img src="immagine1.png" class="esplosione" />
        <img src="immagine2.png" class="esplosione" />
		<img src="immagine1.png" class="esplosione" />
        <img src="immagine2.png" class="esplosione" />
	    <img src="immagine1.png" class="esplosione" />
        <img src="immagine2.png" class="esplosione" />
        <img src="immagine1.png" class="esplosione" />
        <img src="immagine2.png" class="esplosione" />
        <img src="immagine1.png" class="esplosione" />
        <img src="immagine2.png" class="esplosione" />
		<img src="immagine1.png" class="esplosione" />
        <img src="immagine2.png" class="esplosione" />
		<img src="immagine1.png" class="esplosione" />
        <img src="immagine2.png" class="esplosione" />
    </div>
        <div class="input-group">
            <!-- Campo di input nascosto per mantenere il valore della percentuale -->
            <input type="hidden" id="percentuale-input">
            <button onclick="coloraTasselli()" id="bottone-calcola">
    <span id="testo-bottone">%</span>

</button>

        </div>
        <div class="tassello"></div>
        <div class="tassello"></div>
        <div class="tassello"></div>
        <div class="tassello"></div>
        <div class="tassello"></div>
        <div class="tassello"></div>
        <div class="tassello"></div>
        <div class="tassello"></div>
        <div class="tassello"></div>
        <div class="tassello"></div>
        <div style="margin-top: 100px;">
            <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/0tgVpDi06FyKpA1z0VMD4v?utm_source=generator" width="385" height="170" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>
        <div class="container-bottoni">
            <p id="nomeFrase"></p>
            <button id="bottone1">CONDIVIDI</button>
            <a href="https://open.spotify.com/playlist/4DOsjTjwW4ZVJiDKs075cI?si=0d6d8dcd067e4665" id="bottone2">RICALCOLA</a>
        </div>
        <a href="https://open.spotify.com/playlist/4DOsjTjwW4ZVJiDKs075cI?si=8e202438ea61462f" id="bottone3"></a>
    </div> 
    <script>
        window.onload = function() {
            var urlParams = new URLSearchParams(window.location.search);
            var score = parseInt(urlParams.get('score')) - 1270; // Sottrai 1271 dal punteggio
            var name1 = urlParams.get('name1');
            var name2 = urlParams.get('name2');

            document.getElementById('percentuale-input').value = score;

            // Inizia l'animazione, poi mostra la percentuale
            coloraTasselli(function() {
                document.getElementById('valore-percentuale').textContent = score;
                document.getElementById('percentuale-testo').style.display = 'block';
            });

            // Aggiungi la visualizzazione della frase con i nomi
            if (name1 && name2) {
                document.getElementById('nomeFrase').innerHTML = 'La canzone di <br><span class="nomi">' + decodeURIComponent(name1) + ' e ' + decodeURIComponent(name2) + '</span>';
            }
        };

       function coloraTasselli(callback) {
    let percentualeInput = document.getElementById('percentuale-input').value;
    let percentuale = Math.min(Math.max(parseInt(percentualeInput), 0), 100);
    let tasselliFinali = Math.round(10 * percentuale / 100);
    let tasselli = document.querySelectorAll('.tassello');
    let iterazioni = 0;
    let contatoreTasselli = 0;

    document.getElementById('bottone-calcola').textContent = `${percentuale}%`;

    let intervallo = setInterval(() => {
        if (iterazioni >= 18) { // Numero di oscillazioni prima di fermarsi
            clearInterval(intervallo);
            impostaTasselli(tasselli, tasselliFinali);
            if (typeof callback === 'function') {
                callback(); // Chiama il callback dopo l'animazione
            }
            return;
        }

        // Attiva i tasselli in ordine da 1 a 10
        contatoreTasselli = (contatoreTasselli % 10) + 1; 
        impostaTasselli(tasselli, contatoreTasselli);
        iterazioni++;
    }, 150); // Intervallo tra ogni cambiamento (in millisecondi)
}


        const tasselliImmagini = [
            { attivo: '10_1.png', inattivo: '10_2.png' },
            { attivo: '9_1.png', inattivo: '9_2.png' },
            { attivo: '8_1.png', inattivo: '8_2.png' },
            { attivo: '7_1.png', inattivo: '7_2.png' },
            { attivo: '6_1.png', inattivo: '6_2.png' },
            { attivo: '5_1.png', inattivo: '5_2.png' },
            { attivo: '4_1.png', inattivo: '4_2.png' },
            { attivo: '3_1.png', inattivo: '3_2.png' },
            { attivo: '2_1.png', inattivo: '2_2.png' },
            { attivo: '1_1.png', inattivo: '1_2.png' }
        ];

        function impostaTasselli(tasselli, numero) {
            // Spegni tutti i tasselli e reimposta il loro z-index
            tasselli.forEach((tassello, index) => {
                tassello.style.backgroundImage = `url('${tasselliImmagini[index].inattivo}')`;
                tassello.style.zIndex = '1'; // Imposta un valore di base per z-index
            });

            // Accendi solo il tassello specificato
            if (numero > 0 && numero <= tasselli.length) {
                // Il tassello da accendere è determinato dal "love score"
                let tasselloSelezionato = tasselli[tasselli.length - numero];
                tasselloSelezionato.style.backgroundImage = `url('${tasselliImmagini[tasselli.length - numero].attivo}')`;
                tasselloSelezionato.style.zIndex = '2'; // Porta il tassello selezionato in primo piano
            }
        }

        document.getElementById('bottone1').addEventListener('click', function() {
            if (navigator.share) {
                navigator.share({
                    title: 'Condividi il Link',
                    url: window.location.href
                }).then(() => {
                    console.log('Link condiviso con successo!');
                }).catch((error) => {
                    console.log('Errore nella condivisione:', error);
                });
            } else {
                // Gestisci il caso in cui l'API Web Share non è disponibile
                alert('La condivisione non è supportata in questo browser.');
            }
        });
		
		    setTimeout(() => {
        document.querySelectorAll('.esplosione').forEach(elem => {
            const x = Math.random() * 1000 - 550 + 'px'; // Valori casuali per X
            const y = Math.random() * 1000 - 550 + 'px'; // Valori casuali per Y
            elem.style.setProperty('--x', x);
            elem.style.setProperty('--y', y);
            elem.classList.add('esploso');
        });
    }, 3000); // 3000 millisecondi = 3 secondi

    </script>
</body>
</html>


